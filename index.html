<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex" />
  <title>Bewerbung Elternbeirat schreiben</title>
  <style>
    :root { --maxw: 720px; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; background:#f6f7f9; color:#111; }
    .wrap { max-width: var(--maxw); margin: 6vh auto; padding: 24px; }
    .card { background:#fff; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.06); padding: clamp(20px, 4vw, 40px); }
    h1 { font-size: clamp(20px, 4vw, 28px); margin: 0 0 8px; }
    p { line-height: 1.5; margin: 8px 0 8px; }
    .btn { display:inline-block; padding: 10px 14px; border-radius: 8px; text-decoration:none; font-weight:600; border:1px solid #ddd; cursor:pointer; }
    .btn-primary { background:#111; color:#fff; }
    .btn-copy { position:absolute; top:6px; right:6px; background:#f0f0f0; font-size:12px; padding:4px 8px; border-radius:6px; }
    .btn-copy:active { background:#ddd; }
    .muted { color:#555; font-size: 14px; margin-bottom: 4px; }
    .box { position:relative; background:#fafafa; border:1px solid #eee; border-radius:12px; padding:12px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; white-space:pre-wrap; }
    .spacer { height: 14px; }

    /* Auto-open UX: zuerst unsichtbar, nur Fallback zeigen, wenn nötig */
    .stealth { opacity: 0; pointer-events: none; transition: opacity .2s ease; }
    .show    { opacity: 1; pointer-events: auto; }
  </style>
</head>
<body>
  <div id="app" class="wrap stealth">
    <div class="card">
      <h1>Bewerbung Elternbeirat schreiben</h1>
      <p class="muted">Falls die automatische Weiterleitung nicht startet, klicke auf den Button.</p>

      <p><a id="cta" class="btn btn-primary" href="#">Bewerbung per E-Mail öffnen</a></p>

      <div class="spacer"></div>
      <p class="muted">E-Mail-Adresse:</p>
      <div class="box" id="addr">
        <button class="btn-copy" onclick="copyText('addr', this)">Kopieren</button>
        buergermeisterin@stadt-kw.de
      </div>

      <div class="spacer"></div>
      <p class="muted">Betreff:</p>
      <div class="box" id="subj">
        <button class="btn-copy" onclick="copyText('subj', this)">Kopieren</button>
        Bewerbung als Mitglied des Elternbeirats der Stadt Königs Wusterhausen
      </div>

      <div class="spacer"></div>
      <p class="muted">Vorlagentext:</p>
      <div class="box" id="body">
        <button class="btn-copy" onclick="copyText('body', this)">Kopieren</button>
Sehr geehrte Frau Bürgermeisterin,

gemäß § 12 Abs. 3 der Hauptsatzung der Stadt Königs Wusterhausen bewerbe ich mich hiermit als Mitglied des Elternbeirats.

Ich möchte mich aktiv an der Vertretung der Interessen der Kinder und Familien in unserer Stadt beteiligen und einen Beitrag zu einer konstruktiven Zusammenarbeit zwischen Eltern, Einrichtungen und Verwaltung leisten.

Mit freundlichen Grüßen
[Name]
[Kind] | [Einrichtung]
[Telefonnummer] | [Anschrift]
      </div>

      <div class="spacer"></div>
      <p class="muted">Hinweis: Manche Android-WebViews (z. B. in WhatsApp) blockieren direkte Mail-Aufrufe. Dann funktioniert der Button und die Kopier-Funktionen zuverlässig.</p>
    </div>
  </div>

  <!-- versteckter Anker & Iframe für unterschiedliche Browser-Strategien -->
  <a id="hiddenMailto" style="display:none"></a>
  <iframe id="hiddenFrame" style="display:none"></iframe>

  <script>
    // === E-Mail-Daten ===
    const to = "buergermeisterin@stadt-kw.de";
    const subject = "Bewerbung als Mitglied des Elternbeirats der Stadt Königs Wusterhausen";
    const body = [
      "Sehr geehrte Frau Bürgermeisterin,",
      "",
      "gemäß § 12 Abs. 3 der Hauptsatzung der Stadt Königs Wusterhausen bewerbe ich mich hiermit als Mitglied des Elternbeirats.",
      "",
      "Ich möchte mich aktiv an der Vertretung der Interessen der Kinder und Familien in unserer Stadt beteiligen und einen Beitrag zu einer konstruktiven Zusammenarbeit zwischen Eltern, Einrichtungen und Verwaltung leisten.",
      "",
      "Mit freundlichen Grüßen",
      "[Name]",
      "[Kind] | [Einrichtung]",
      "[Telefonnummer] | [Anschrift]"
    ].join("\n");

    function buildMailto() {
      const s = encodeURIComponent(subject);
      const b = encodeURIComponent(body);
      return `mailto:${to}?subject=${s}&body=${b}`;
    }

    // Primärer Button
    const cta = document.getElementById("cta");
    cta.href = buildMailto();

    // --- Auto-Open-Strategie ---
    // 1) Direktversuch
    // 2) Programmatic Click auf <a>
    // 3) Fallback via hidden iframe (manche iOS-Versionen)
    // 4) Wenn nichts „greift“, zeige UI nach kurzer Zeit
    (function autoOpen() {
      const url = buildMailto();

      // Zurück-Navigation hübsch halten (kein Endlos-Zurück nach Deep-Link)
      if (history.replaceState) {
        history.replaceState(null, "", location.href.split("#")[0]);
      }

      let opened = false;
      try { window.location.href = url; opened = true; } catch(e) {}

      setTimeout(() => {
        if (!opened) {
          try {
            const a = document.getElementById("hiddenMailto");
            a.href = url;
            a.click();
          } catch(e) {}
        }
      }, 150);

      setTimeout(() => {
        if (!opened) {
          try {
            const f = document.getElementById("hiddenFrame");
            f.src = url;
          } catch(e) {}
        }
      }, 300);

      // Nach kurzer Wartezeit UI einblenden, falls nichts passierte
      setTimeout(() => {
        document.getElementById("app").classList.remove("stealth");
        document.getElementById("app").classList.add("show");
      }, 650);
    })();

    // Kopierfunktion (Box-Inhalt ohne Button)
    function copyText(id, btn) {
      const el = document.getElementById(id);
      const text = Array.from(el.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent).join("").trim();
      navigator.clipboard.writeText(text).then(() => {
        const old = btn.innerText;
        btn.innerText = "✔️";
        setTimeout(() => { btn.innerText = "Kopieren"; }, 1200);
      });
    }
  </script>

  <noscript>
    <div style="max-width:720px;margin:0 auto;padding:0 24px 24px;">
      <p><a class="btn" href="mailto:buergermeisterin@stadt-kw.de">E-Mail schreiben (Fallback)</a></p>
    </div>
  </noscript>
</body>
</html>
